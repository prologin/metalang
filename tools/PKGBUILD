# Maintainer: Kilian Guillaume "cafehaine" <kilian dot guillaume at gmail dot com>
pkgname=metalang-git
_realname=metalang
pkgver=r1452.067b70d2
pkgrel=1
pkgdesc="Metalang compiler"
arch=('x86_64' 'i686')
url="https://github.com/prologin/metalang/"
license=('BSD2')
provides=('metalang')
depends=()
makedepends=('ocamlbuild' 'ocaml-findlib' 'ocaml-menhir')
#TODO fixme
source=("git+https://github.com/cafehaine/metalang/")
md5sums=('SKIP')

pkgver() {
	cd "$srcdir/$_realname"
	printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
	cd "$srcdir/$_realname"
	make metalang
}

package() {
	cd "$srcdir/$_realname"
	install -Dm644 LICENCE "$pkgdir/usr/share/licenses/$_realname/LICENSE"
	install -Dm755 metalang "$pkgdir/usr/bin/$_realname"
	install -Dm644 Stdlib/stdlib.metalang "$pkgdir/usr/lib/$_realname/stdlib.metalang"
}

